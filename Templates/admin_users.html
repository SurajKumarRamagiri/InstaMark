{% extends "admin_base.html" %}

{% block title %}User Management - InstaMark{% endblock %}

<div class="sidebar">
    {% block sidebar %}
    <a class ='active' href="{% url 'admin_dashboard'%}">
        <i class="fas fa-tachometer-alt"></i>
        <span>Users</span>
    </a>
    {% endblock %}
</div>

{% block content %}
<div class="card">
    <div class="card-title">User  Management</div>
    <button id="addUser Btn" style="margin-bottom: 20px;">Add New User</button>
    <table class="table">
        <thead>
            <tr>
                <th>Name</th>
                <th>Role</th>
                <th>Attendance Status</th>
                <th>Last Active</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody id="userTableBody">
            <tr>
                <td>John Doe</td>
                <td>Admin</td>
                <td>Present</td>
                <td>Today</td>
                <td class="actions">
                    <i class="fas fa-pencil-alt" title="Edit" onclick="editUser ('John Doe')"></i>
                    <i class="fas fa-trash" title="Delete" onclick="removeUser (this)"></i>
                    <i class="fas fa-eye" title="View" onclick="viewUser ('John Doe')"></i>
                </td>
            </tr>
            <tr>
                <td>Jane Smith</td>
                <td>User</td>
                <td>Absent</td>
                <td>Yesterday</td>
                <td class="actions">
                    <i class="fas fa-pencil-alt" title="Edit" onclick="editUser ('Jane Smith')"></i>
                    <i class="fas fa-trash" title="Delete" onclick="removeUser (this)"></i>
                    <i class="fas fa-eye" title="View" onclick="viewUser ('Jane Smith')"></i>
                </td>
            </tr>
            <tr>
                <td>Michael Brown</td>
                <td>User</td>
                <td>Late</td>
                <td>Today</td>
                <td class="actions">
                    <i class="fas fa-pencil-alt" title="Edit" onclick="editUser ('Michael Brown')"></i>
                    <i class="fas fa-trash" title="Delete" onclick="removeUser (this)"></i>
                    <i class="fas fa-eye" title="View" onclick="viewUser ('Michael Brown')"></i>
                </td>
            </tr>
        </tbody>
    </table>
</div>

<!-- Add User Modal -->
<div id="addUser Modal" style="display:none; position:fixed; top:50%; left:50%; transform:translate(-50%, -50%); background:white; padding:20px; box-shadow:0 0 10px rgba(0,0,0,0.5); z-index:1000;">
    <h3>Add New User</h3>
    <label for="userName">Name:</label>
    <input type="text" id="userName" required>
    <label for="userRole">Role:</label>
    <select id="userRole">
        <option value="Admin">Admin</option>
        <option value="User ">User </option>
    </select>
    <button onclick="addUser ()">Add User</button>
    <button onclick="closeModal()">Cancel</button>
</div>

<div id="modalOverlay" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:999;"></div>

<script>
    document.getElementById('addUser Btn').onclick = function() {
        document.getElementById('addUser Modal').style.display = 'block';
        document.getElementById('modalOverlay').style.display = 'block';
    };

    function closeModal() {
        document.getElementById('addUser Modal').style.display = 'none';
        document.getElementById('modalOverlay').style.display = 'none';
    }

    function addUser () {
        const userName = document.getElementById('userName').value;
        const userRole = document.getElementById('userRole').value;

        if (userName) {
            const newRow = document.createElement('tr');
            newRow.innerHTML = `
                <td>${userName}</td>
                <td>${userRole}</td>
                <td>Present</td>
                <td>Today</td>
                <td class="actions">
                                        <i class="fas fa-pencil-alt" title="Edit" onclick="editUser ('${userName}')"></i>
                    <i class="fas fa-trash" title="Delete" onclick="removeUser (this)"></i>
                    <i class="fas fa-eye" title="View" onclick="viewUser ('${userName}')"></i>
                </td>
            </tr>
            `;
            document.getElementById('userTableBody').appendChild(newRow);
            closeModal(); // Close the modal after adding the user
            document.getElementById('userName').value = ''; // Clear the input field
        } else {
            alert('Please enter a name for the user.');
        }
    }

    function removeUser (element) {
        const row = element.closest('tr');
        if (confirm('Are you sure you want to delete this user?')) {
            row.remove(); // Remove the user row from the table
        }
    }

    function editUser (userName) {
        alert(`Edit functionality for ${userName} is not implemented yet.`);
    }

    function viewUser (userName) {
        alert(`View functionality for ${userName} is not implemented yet.`);
    }
</script>

{% endblock %}
                    